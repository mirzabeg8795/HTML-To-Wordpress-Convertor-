<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML to WordPress Theme Converter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.5/purify.min.js"></script>
    <style>
        .code-block { background-color: #f5f5f5; padding: 1rem; border-radius: 0.5rem; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .nav-tab.active { border-color: #3b82f6; color: #2563eb; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold text-center mb-8">HTML to WordPress Theme Converter</h1>
        
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h2 class="text-xl font-semibold mb-4">Input Your HTML</h2>
                    <textarea id="html-input" class="w-full h-64 p-4 border border-gray-300 rounded-lg font-mono text-sm" 
                              placeholder="<!DOCTYPE html>..."></textarea>
                </div>
                <div>
                    <h2 class="text-xl font-semibold mb-4">Theme Options</h2>
                    <div class="space-y-4">
                        <input type="text" id="theme-name" class="w-full p-2 border rounded" placeholder="Theme Name" value="My Theme">
                        <input type="text" id="theme-uri" class="w-full p-2 border rounded" placeholder="Theme URI">
                        <input type="text" id="theme-author" class="w-full p-2 border rounded" placeholder="Author" value="John Doe">
                        <input type="text" id="theme-author-uri" class="w-full p-2 border rounded" placeholder="Author URI">
                        <textarea id="theme-description" class="w-full p-2 border rounded" rows="2">A custom WordPress theme</textarea>
                    </div>
                </div>
            </div>
            
            <div class="mt-6 flex gap-4 justify-center">
                <button id="analyze-btn" class="px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                    Analyze HTML
                </button>
                <button id="generate-btn" class="px-6 py-2 bg-green-600 text-white rounded hover:bg-green-700">
                    Generate Theme
                </button>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-lg">
            <div class="border-b border-gray-200">
                <nav class="flex" id="tabs-nav">
                    <button data-tab="header" class="nav-tab px-4 py-2 active">header.php</button>
                    <button data-tab="footer" class="nav-tab px-4 py-2">footer.php</button>
                    <button data-tab="functions" class="nav-tab px-4 py-2">functions.php</button>
                    <button data-tab="style" class="nav-tab px-4 py-2">style.css</button>
                    <button data-tab="index" class="nav-tab px-4 py-2">index.php</button>
                </nav>
            </div>
            
            <div class="p-6">
                <div id="header" class="tab-content active">
                    <pre class="code-block" id="header-output"></pre>
                </div>
                <div id="footer" class="tab-content">
                    <pre class="code-block" id="footer-output"></pre>
                </div>
                <div id="functions" class="tab-content">
                    <pre class="code-block" id="functions-output"></pre>
                </div>
                <div id="style" class="tab-content">
                    <pre class="code-block" id="style-output"></pre>
                </div>
                <div id="index" class="tab-content">
                    <pre class="code-block" id="index-output"></pre>
                </div>
            </div>
            
            <div class="border-t border-gray-200 px-6 py-4 bg-gray-50">
                <button id="download-btn" class="px-6 py-2 bg-green-600 text-white rounded hover:bg-green-700">
                    Download Theme
                </button>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        class ThemeConverter {
            constructor() {
                this.zip = new JSZip();
                this.files = {};
                this.initEventListeners();
                this.initTabs();
            }

            initEventListeners() {
                document.getElementById('analyze-btn').addEventListener('click', () => this.analyzeHTML());
                document.getElementById('generate-btn').addEventListener('click', () => this.generateTheme());
                document.getElementById('download-btn').addEventListener('click', () => this.downloadTheme());
            }

            initTabs() {
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                        
                        const tabId = tab.dataset.tab;
                        tab.classList.add('active');
                        document.getElementById(tabId).classList.add('active');
                    });
                });
            }

            analyzeHTML() {
                try {
                    const html = this.sanitizeInput(document.getElementById('html-input').value);
                    if (!html) throw new Error('Please input HTML content');
                    
                    const doc = new DOMParser().parseFromString(html, 'text/html');
                    this.showPreviewAnalysis(doc);
                    
                } catch (error) {
                    this.showError(error);
                }
            }

            showPreviewAnalysis(doc) {
                // Clear previous previews
                document.querySelectorAll('.code-block').forEach(el => el.textContent = '');
                
                // Detect components
                const header = doc.querySelector('header')?.outerHTML || '<!-- No header detected -->';
                const footer = doc.querySelector('footer')?.outerHTML || '<!-- No footer detected -->';
                const mainContent = doc.querySelector('main')?.outerHTML || doc.body?.innerHTML;
                
                // Show previews
                document.getElementById('header-output').textContent = header;
                document.getElementById('footer-output').textContent = footer;
                document.getElementById('index-output').textContent = mainContent;
                
                alert('Analysis complete! Check header/footer tabs for detected content.');
            }

            generateTheme() {
                try {
                    const html = this.sanitizeInput(document.getElementById('html-input').value);
                    if (!html) throw new Error('Please input HTML content');
                    
                    const doc = new DOMParser().parseFromString(html, 'text/html');
                    this.createThemeFiles(doc);
                    this.updateCodePreviews();
                    
                } catch (error) {
                    this.showError(error);
                }
            }

            createThemeFiles(doc) {
                const themeData = this.getThemeData();
                
                this.files = {
                    header: this.generateHeader(doc, themeData),
                    footer: this.generateFooter(doc, themeData),
                    functions: this.generateFunctions(themeData),
                    style: this.generateStyles(themeData),
                    index: this.generateIndex(doc, themeData)
                };
            }

            generateHeader(doc, themeData) {
                const headerContent = doc.querySelector('header')?.outerHTML || '<header><!-- Default header content --></header>';
                return `<?php
/**
 * Header template for ${themeData.name}
 */
?><!DOCTYPE html>
<html <?php language_attributes(); ?>>
<head>
    <meta charset="<?php bloginfo('charset'); ?>">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <?php wp_head(); ?>
</head>
<body <?php body_class(); ?>>
${headerContent}`;
            }

            generateFooter(doc, themeData) {
                const footerContent = doc.querySelector('footer')?.outerHTML || '<footer><!-- Default footer content --></footer>';
                return `<?php
/**
 * Footer template for ${themeData.name}
 */
?>
${footerContent}
<?php wp_footer(); ?>
</body>
</html>`;
            }

            generateFunctions(themeData) {
                return `<?php
/**
 * Theme functions file for ${themeData.name}
 */
 
function ${themeData.slug}_setup() {
    add_theme_support('title-tag');
    add_theme_support('post-thumbnails');
    register_nav_menus([
        'primary' => __('Primary Menu', '${themeData.slug}')
    ]);
}
add_action('after_setup_theme', '${themeData.slug}_setup');`;
            }

            generateStyles(themeData) {
                return `/*
Theme Name: ${themeData.name}
Author: ${themeData.author}
Description: ${themeData.description}
Version: 1.0
*/

/* Add your custom styles below */`;
            }

            generateIndex(doc, themeData) {
                const content = doc.querySelector('main')?.outerHTML || doc.body?.innerHTML;
                return `<?php
/**
 * Main template file
 */
get_header();
?>

<main id="main-content">
${content}
</main>

<?php
get_footer();
?>`;
            }

            async downloadTheme() {
                try {
                    if (!Object.keys(this.files).length) throw new Error('Generate theme first');
                    
                    const themeFolder = this.zip.folder(this.getThemeData().slug);
                    Object.entries(this.files).forEach(([name, content]) => {
                        themeFolder.file(`${name}.php`, content);
                    });
                    themeFolder.file("style.css", this.files.style);
                    
                    const content = await this.zip.generateAsync({ type: "blob" });
                    this.triggerDownload(content);
                    
                } catch (error) {
                    this.showError(error);
                }
            }

            // Helper methods
            sanitizeInput(html) {
                return DOMPurify.sanitize(html);
            }

            getThemeData() {
                const name = document.getElementById('theme-name').value.trim() || 'My Theme';
                return {
                    name,
                    slug: name.toLowerCase().replace(/ /g, '-'),
                    author: document.getElementById('theme-author').value.trim(),
                    description: document.getElementById('theme-description').value.trim()
                };
            }

            triggerDownload(content) {
                const url = URL.createObjectURL(content);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${this.getThemeData().slug}.zip`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            updateCodePreviews() {
                Object.entries(this.files).forEach(([name, content]) => {
                    const output = document.getElementById(`${name}-output`);
                    if (output) output.textContent = content;
                });
            }

            showError(error) {
                console.error(error);
                alert(`Error: ${error.message}`);
            }
        }

        // Initialize converter
        new ThemeConverter();
    });
    </script>
</body>
</html>
